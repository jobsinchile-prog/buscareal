<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarketPlace Inverso | Compradores Publican, Vendedores Proponen</title>
    <link rel="manifest" id="manifest-placeholder">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîÑ</text></svg>">
    <style>
        /* RESET Y ESTILOS BASE */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #ef233c;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border-radius: 12px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 80px; /* Espacio para men√∫ m√≥vil */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* UTILIDADES */
        .hidden {
            display: none !important;
        }

        .view {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .view.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: var(--dark);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-block {
            width: 100%;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge-success {
            background-color: rgba(76, 201, 240, 0.2);
            color: #1a7a8f;
        }

        .badge-warning {
            background-color: rgba(247, 37, 133, 0.2);
            color: #a3164d;
        }

        .badge-danger {
            background-color: rgba(239, 35, 60, 0.2);
            color: #b91c2c;
        }

        .badge-info {
            background-color: rgba(67, 97, 238, 0.2);
            color: var(--primary-dark);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* HEADER Y NAVEGACI√ìN */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .logo-icon {
            font-size: 28px;
        }

        .desktop-nav {
            display: none;
        }

        .desktop-nav a {
            margin-left: 24px;
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .desktop-nav a:hover {
            color: var(--primary);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* MEN√ö M√ìVIL */
        .mobile-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.08);
            z-index: 90;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--gray);
            font-size: 0.8rem;
            gap: 4px;
            transition: var(--transition);
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item i {
            font-size: 20px;
        }

        /* LANDING PAGE */
        #landing {
            padding-top: 40px;
        }

        .hero {
            text-align: center;
            padding: 60px 0;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--gray);
            margin-bottom: 40px;
        }

        .features {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-top: 60px;
        }

        .feature {
            text-align: center;
            padding: 30px;
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 20px;
            color: var(--primary);
        }

        /* AUTENTICACI√ìN */
        .auth-form {
            max-width: 500px;
            margin: 40px auto;
        }

        .auth-form h2 {
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* DASHBOARDS */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .solicitudes-grid, .propuestas-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .solicitud-card, .propuesta-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary);
        }

        .solicitud-card:hover, .propuesta-card:hover {
            transform: translateX(4px);
        }

        .solicitud-header, .propuesta-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .solicitud-title, .propuesta-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
        }

        .solicitud-meta, .propuesta-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .solicitud-actions, .propuesta-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* FILTROS */
        .filters {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .filters-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        /* CHAT */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 70vh;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .chat-header {
            padding: 20px;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
        }

        .message-sent {
            align-self: flex-end;
            background-color: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-received {
            align-self: flex-start;
            background-color: var(--gray-light);
            color: var(--dark);
            border-bottom-left-radius: 4px;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 4px;
        }

        .chat-input {
            display: flex;
            padding: 20px;
            background-color: white;
            border-top: 1px solid var(--gray-light);
        }

        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--gray-light);
            border-radius: 20px;
            margin-right: 10px;
        }

        /* PANEL ADMIN */
        .admin-section {
            margin-bottom: 40px;
        }

        .admin-section h3 {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--gray-light);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .data-table th, .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-light);
        }

        .data-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f9f9f9;
        }

        /* INSTALAR PWA */
        #install-pwa {
            position: fixed;
            bottom: 100px;
            right: 20px;
            z-index: 1000;
            animation: slideInUp 0.5s ease;
        }

        /* ANIMACIONES */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* RESPONSIVE */
        @media (min-width: 768px) {
            .desktop-nav {
                display: flex;
            }
            
            .mobile-nav {
                display: none;
            }
            
            body {
                padding-bottom: 0;
            }
            
            .features {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .solicitudes-grid, .propuestas-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 992px) {
            .solicitudes-grid, .propuestas-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <span class="logo-icon">üîÑ</span>
                <span>MarketPlace Inverso</span>
            </div>
            
            <nav class="desktop-nav">
                <a href="#" onclick="showView('landing')">Inicio</a>
                <a href="#" onclick="showView('dashboard')" id="nav-dashboard" class="hidden">Dashboard</a>
                <a href="#" onclick="showView('solicitudes')" id="nav-solicitudes" class="hidden">Solicitudes</a>
                <a href="#" onclick="showView('propuestas')" id="nav-propuestas" class="hidden">Propuestas</a>
                <a href="#" onclick="showView('perfil')" id="nav-perfil" class="hidden">Perfil</a>
                <a href="#" onclick="showView('admin')" id="nav-admin" class="hidden">Admin</a>
            </nav>
            
            <div class="user-menu">
                <div id="user-info" class="hidden">
                    <span id="user-role-badge" class="badge"></span>
                </div>
                <div id="user-avatar" class="user-avatar hidden"></div>
                <button id="login-btn" class="btn btn-primary" onclick="showView('login')">Iniciar Sesi√≥n</button>
                <button id="logout-btn" class="btn btn-outline hidden" onclick="logout()">Cerrar Sesi√≥n</button>
            </div>
        </div>
    </header>

    <!-- VISTAS -->
    <main class="container">
        <!-- LANDING -->
        <section id="landing" class="view active">
            <div class="hero">
                <h1>MarketPlace Inverso</h1>
                <p>Publica lo que buscas y deja que los vendedores compitan por ofrecerte la mejor opci√≥n. Sin cat√°logos, sin b√∫squedas infinitas.</p>
                <div>
                    <button class="btn btn-primary btn-lg" onclick="showView('register')">Comenzar Gratis</button>
                    <button class="btn btn-outline btn-lg" onclick="showView('login')">Iniciar Sesi√≥n</button>
                </div>
            </div>
            
            <div class="features">
                <div class="feature card">
                    <div class="feature-icon">üìù</div>
                    <h3>Publica tu Demanda</h3>
                    <p>Describe exactamente lo que necesitas: auto, inmueble, o cualquier producto.</p>
                </div>
                <div class="feature card">
                    <div class="feature-icon">üèÜ</div>
                    <h3>Vendedores Compiten</h3>
                    <p>Recibe propuestas personalizadas de m√∫ltiples vendedores interesados.</p>
                </div>
                <div class="feature card">
                    <div class="feature-icon">ü§ù</div>
                    <h3>Negocia Directamente</h3>
                    <p>Chat integrado para negociar detalles y cerrar el mejor trato.</p>
                </div>
            </div>
        </section>

        <!-- LOGIN -->
        <section id="login" class="view">
            <div class="auth-form card">
                <h2>Iniciar Sesi√≥n</h2>
                <form id="login-form" onsubmit="login(event)">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Contrase√±a</label>
                        <input type="password" id="login-password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Ingresar</button>
                </form>
                <p style="text-align: center; margin-top: 20px;">
                    ¬øNo tienes cuenta? <a href="#" onclick="showView('register')">Reg√≠strate aqu√≠</a>
                </p>
            </div>
        </section>

        <!-- REGISTRO -->
        <section id="register" class="view">
            <div class="auth-form card">
                <h2>Crear Cuenta</h2>
                <form id="register-form" onsubmit="register(event)">
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Contrase√±a</label>
                        <input type="password" id="register-password" class="form-control" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label>Rol</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="role" value="comprador" checked> Comprador
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="role" value="vendedor"> Vendedor
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Crear Cuenta</button>
                </form>
                <p style="text-align: center; margin-top: 20px;">
                    ¬øYa tienes cuenta? <a href="#" onclick="showView('login')">Inicia sesi√≥n aqu√≠</a>
                </p>
            </div>
        </section>

        <!-- DASHBOARD COMPRADOR/VENDEDOR -->
        <section id="dashboard" class="view">
            <div class="dashboard-header">
                <h2 id="dashboard-title">Dashboard</h2>
                <button id="create-request-btn" class="btn btn-primary hidden" onclick="showView('crear-solicitud')">
                    <span>‚ûï</span> Nueva Solicitud
                </button>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="stat-solicitudes">0</div>
                    <div class="stat-label">Solicitudes Activas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-propuestas">0</div>
                    <div class="stat-label">Propuestas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-negociando">0</div>
                    <div class="stat-label">En Negociaci√≥n</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-cerradas">0</div>
                    <div class="stat-label">Cerradas</div>
                </div>
            </div>
            
            <h3 style="margin-bottom: 20px;">Solicitudes Recientes</h3>
            <div id="dashboard-solicitudes" class="solicitudes-grid">
                <!-- Se llena din√°micamente -->
            </div>
            
            <h3 style="margin: 40px 0 20px;">Propuestas Recientes</h3>
            <div id="dashboard-propuestas" class="propuestas-grid">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- CREAR SOLICITUD -->
        <section id="crear-solicitud" class="view">
            <div class="card">
                <h2>Publicar Nueva Solicitud</h2>
                <form id="solicitud-form" onsubmit="crearSolicitud(event)">
                    <div class="form-group">
                        <label for="solicitud-tipo">Tipo</label>
                        <select id="solicitud-tipo" class="form-control" required>
                            <option value="">Selecciona un tipo</option>
                            <option value="auto">Auto</option>
                            <option value="inmueble">Inmueble</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="solicitud-titulo">T√≠tulo de tu solicitud</label>
                        <input type="text" id="solicitud-titulo" class="form-control" placeholder="Ej: Busco apartamento de 2 habitaciones" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="solicitud-descripcion">Descripci√≥n detallada</label>
                        <textarea id="solicitud-descripcion" class="form-control" rows="4" placeholder="Describe exactamente lo que buscas, caracter√≠sticas importantes, preferencias, etc." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="solicitud-presupuesto">Presupuesto m√°ximo (USD)</label>
                        <input type="number" id="solicitud-presupuesto" class="form-control" min="0" step="100" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="solicitud-zona">Zona o ubicaci√≥n</label>
                        <input type="text" id="solicitud-zona" class="form-control" placeholder="Ej: Centro ciudad, Zona norte, etc." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="solicitud-urgencia">Nivel de urgencia</label>
                        <select id="solicitud-urgencia" class="form-control" required>
                            <option value="baja">Baja (1-3 meses)</option>
                            <option value="media" selected>Media (2-4 semanas)</option>
                            <option value="alta">Alta (1 semana)</option>
                            <option value="inmediata">Inmediata</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button type="button" class="btn btn-outline" onclick="showView('dashboard')">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Publicar Solicitud</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- LISTA DE SOLICITUDES -->
        <section id="solicitudes" class="view">
            <div class="dashboard-header">
                <h2 id="solicitudes-title">Solicitudes</h2>
                <button id="filter-toggle" class="btn btn-outline" onclick="toggleFilters()">
                    <span>üîç</span> Filtros
                </button>
            </div>
            
            <div id="filters-container" class="filters hidden">
                <div class="filters-row">
                    <div>
                        <label>Tipo</label>
                        <select id="filter-tipo" class="form-control">
                            <option value="">Todos</option>
                            <option value="auto">Auto</option>
                            <option value="inmueble">Inmueble</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    <div>
                        <label>Presupuesto m√°ximo</label>
                        <input type="number" id="filter-presupuesto" class="form-control" placeholder="USD">
                    </div>
                    <div>
                        <label>Estado</label>
                        <select id="filter-estado" class="form-control">
                            <option value="">Todos</option>
                            <option value="abierto">Abierto</option>
                            <option value="negociando">Negociando</option>
                            <option value="cerrado">Cerrado</option>
                        </select>
                    </div>
                </div>
                <div style="text-align: right; margin-top: 15px;">
                    <button class="btn btn-sm btn-outline" onclick="aplicarFiltros()">Aplicar Filtros</button>
                    <button class="btn btn-sm" onclick="limpiarFiltros()">Limpiar</button>
                </div>
            </div>
            
            <div id="solicitudes-list" class="solicitudes-grid">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- DETALLE SOLICITUD -->
        <section id="detalle-solicitud" class="view">
            <div id="detalle-solicitud-content">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- PROPUESTAS RECIBIDAS -->
        <section id="propuestas-recibidas" class="view">
            <div class="dashboard-header">
                <h2>Propuestas Recibidas</h2>
            </div>
            
            <div id="propuestas-recibidas-list">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- PROPUESTAS ENVIADAS -->
        <section id="propuestas-enviadas" class="view">
            <div class="dashboard-header">
                <h2>Propuestas Enviadas</h2>
            </div>
            
            <div id="propuestas-enviadas-list">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- CHAT -->
        <section id="chat" class="view">
            <div id="chat-container">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- PERFIL -->
        <section id="perfil" class="view">
            <div class="card">
                <h2>Mi Perfil</h2>
                <div id="profile-info">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>
        </section>

        <!-- PANEL ADMIN -->
        <section id="admin" class="view">
            <div class="dashboard-header">
                <h2>Panel de Administraci√≥n</h2>
                <button class="btn btn-danger" onclick="resetSystem()">üîÅ Resetear Sistema</button>
            </div>
            
            <div class="admin-section">
                <h3>Usuarios Registrados</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Email</th>
                            <th>Rol</th>
                            <th>Registro</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="admin-users-list">
                        <!-- Se llena din√°micamente -->
                    </tbody>
                </table>
            </div>
            
            <div class="admin-section">
                <h3>Todas las Solicitudes</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>T√≠tulo</th>
                            <th>Tipo</th>
                            <th>Usuario</th>
                            <th>Presupuesto</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="admin-solicitudes-list">
                        <!-- Se llena din√°micamente -->
                    </tbody>
                </table>
            </div>
            
            <div class="admin-section">
                <h3>Todas las Propuestas</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Solicitud</th>
                            <th>Vendedor</th>
                            <th>Precio</th>
                            <th>Fecha</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="admin-propuestas-list">
                        <!-- Se llena din√°micamente -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- MEN√ö M√ìVIL -->
    <nav class="mobile-nav">
        <a href="#" class="nav-item" onclick="showView('dashboard')">
            <span>üìä</span>
            <span>Dashboard</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('solicitudes')">
            <span>üìù</span>
            <span>Solicitudes</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('crear-solicitud')">
            <span>‚ûï</span>
            <span>Nueva</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('propuestas')">
            <span>üì®</span>
            <span>Propuestas</span>
        </a>
        <a href="#" class="nav-item" onclick="showView('perfil')">
            <span>üë§</span>
            <span>Perfil</span>
        </a>
    </nav>

    <!-- BOT√ìN INSTALAR PWA -->
    <div id="install-pwa" class="hidden">
        <button id="install-btn" class="btn btn-primary" style="box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
            <span>‚¨áÔ∏è</span> Instalar App
        </button>
    </div>

    <!-- SCRIPT PRINCIPAL -->
    <script>
        // ============================================
        // VARIABLES GLOBALES Y ESTADO
        // ============================================
        let currentUser = null;
        let deferredPrompt = null;
        const APP_KEY = 'marketplace_inverso_data';
        
        // ============================================
        // DATOS INICIALES DE EJEMPLO
        // ============================================
        const initialData = {
            users: [
                { id: 1, email: "comprador@demo.com", password: "123456", role: "comprador", createdAt: new Date().toISOString() },
                { id: 2, email: "vendedor@demo.com", password: "123456", role: "vendedor", createdAt: new Date().toISOString() },
                { id: 3, email: "admin@demo.com", password: "admin123", role: "admin", createdAt: new Date().toISOString() }
            ],
            solicitudes: [
                { 
                    id: 1, 
                    userId: 1, 
                    tipo: "auto", 
                    titulo: "Busco SUV familiar 2020-2022", 
                    descripcion: "Necesito un SUV familiar con espacio para 5 personas, preferiblemente marca Toyota o Honda. Debe estar en buen estado, m√°ximo 40,000 km.",
                    presupuesto: 35000, 
                    zona: "Ciudad Capital", 
                    urgencia: "media", 
                    estado: "abierto",
                    createdAt: new Date().toISOString(),
                    propuestas: [2]
                },
                { 
                    id: 2, 
                    userId: 1, 
                    tipo: "inmueble", 
                    titulo: "Apartamento 3 habitaciones cerca de universidad", 
                    descripcion: "Busco apartamento para familia de 4, m√≠nimo 3 habitaciones, 2 ba√±os. Preferiblemente en edificio con √°reas verdes y seguridad 24/7.",
                    presupuesto: 250000, 
                    zona: "Zona Norte", 
                    urgencia: "baja", 
                    estado: "negociando",
                    createdAt: new Date(Date.now() - 86400000).toISOString(), // 1 d√≠a atr√°s
                    propuestas: [1]
                }
            ],
            propuestas: [
                { 
                    id: 1, 
                    solicitudId: 2, 
                    vendedorId: 2, 
                    precio: 240000, 
                    mensaje: "Tengo exactamente lo que buscas. Apartamento en condominio seguro, 3 hab, 2 ba√±os, parqueadero. Podemos negociar el precio.",
                    estado: "pendiente",
                    createdAt: new Date().toISOString()
                },
                { 
                    id: 2, 
                    solicitudId: 1, 
                    vendedorId: 2, 
                    precio: 32000, 
                    mensaje: "Toyota RAV4 2021, 35,000 km, excelente estado. Incluye garant√≠a extendida. Disponible para prueba de manejo.",
                    estado: "pendiente",
                    createdAt: new Date().toISOString()
                }
            ],
            chats: [
                {
                    id: 1,
                    solicitudId: 2,
                    participantes: [1, 2],
                    mensajes: [
                        { id: 1, userId: 2, text: "Hola, vi tu solicitud y tengo una propuesta que podr√≠a interesarte.", timestamp: new Date(Date.now() - 3600000).toISOString() },
                        { id: 2, userId: 1, text: "Hola, s√≠, me interesa. ¬øPodr√≠as darme m√°s detalles?", timestamp: new Date(Date.now() - 1800000).toISOString() },
                        { id: 3, userId: 2, text: "Claro, es un apartamento de 120m2, 3 habitaciones, 2 ba√±os, cocina integral. Est√° en el condominio 'Los Pinos'.", timestamp: new Date().toISOString() }
                    ]
                }
            ],
            nextIds: {
                users: 4,
                solicitudes: 3,
                propuestas: 3,
                chats: 2
            }
        };

        // ============================================
        // FUNCIONES DE PERSISTENCIA
        // ============================================
        function loadData() {
            const data = localStorage.getItem(APP_KEY);
            if (!data) {
                saveData(initialData);
                return initialData;
            }
            return JSON.parse(data);
        }

        function saveData(data) {
            localStorage.setItem(APP_KEY, JSON.stringify(data));
        }

        function getData() {
            return loadData();
        }

        function updateData(updates) {
            const data = getData();
            Object.assign(data, updates);
            saveData(data);
            return data;
        }

        // ============================================
        // FUNCIONES DE AUTENTICACI√ìN
        // ============================================
        function login(event) {
            event.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const data = getData();
            
            const user = data.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showUserUI();
                showView('dashboard');
                updateDashboard();
                showToast('Sesi√≥n iniciada correctamente', 'success');
            } else {
                showToast('Email o contrase√±a incorrectos', 'error');
            }
        }

        function register(event) {
            event.preventDefault();
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const role = document.querySelector('input[name="role"]:checked').value;
            const data = getData();
            
            // Verificar si el usuario ya existe
            if (data.users.find(u => u.email === email)) {
                showToast('Este email ya est√° registrado', 'error');
                return;
            }
            
            const newUser = {
                id: data.nextIds.users++,
                email,
                password,
                role,
                createdAt: new Date().toISOString()
            };
            
            data.users.push(newUser);
            saveData(data);
            
            showToast('Cuenta creada exitosamente. Ahora puedes iniciar sesi√≥n.', 'success');
            showView('login');
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            hideUserUI();
            showView('landing');
            showToast('Sesi√≥n cerrada', 'info');
        }

        function checkAuth() {
            const userData = localStorage.getItem('currentUser');
            if (userData) {
                currentUser = JSON.parse(userData);
                showUserUI();
                showView('dashboard');
                updateDashboard();
            }
        }

        // ============================================
        // FUNCIONES DE INTERFAZ
        // ============================================
        function showView(viewId) {
            // Ocultar todas las vistas
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // Mostrar la vista solicitada
            const targetView = document.getElementById(viewId);
            if (targetView) {
                targetView.classList.add('active');
            }
            
            // Actualizar navegaci√≥n activa
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Actualizar t√≠tulo din√°mico
            if (currentUser) {
                if (viewId === 'dashboard') {
                    document.getElementById('dashboard-title').textContent = 
                        currentUser.role === 'comprador' ? 'Mi Dashboard - Comprador' : 'Mi Dashboard - Vendedor';
                    updateDashboard();
                }
                
                if (viewId === 'solicitudes') {
                    document.getElementById('solicitudes-title').textContent = 
                        currentUser.role === 'comprador' ? 'Mis Solicitudes' : 'Solicitudes Disponibles';
                    loadSolicitudes();
                }
            }
            
            // Mostrar/ocultar botones seg√∫n rol
            const createBtn = document.getElementById('create-request-btn');
            if (createBtn) {
                createBtn.classList.toggle('hidden', currentUser?.role !== 'comprador');
            }
            
            // Cargar datos espec√≠ficos de la vista
            switch(viewId) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'solicitudes':
                    loadSolicitudes();
                    break;
                case 'propuestas-recibidas':
                    loadPropuestasRecibidas();
                    break;
                case 'propuestas-enviadas':
                    loadPropuestasEnviadas();
                    break;
                case 'perfil':
                    loadProfile();
                    break;
                case 'admin':
                    if (currentUser?.role === 'admin') {
                        loadAdminPanel();
                    } else {
                        showView('dashboard');
                    }
                    break;
            }
        }

        function showUserUI() {
            // Mostrar elementos para usuario autenticado
            document.getElementById('login-btn').classList.add('hidden');
            document.getElementById('logout-btn').classList.remove('hidden');
            document.getElementById('user-info').classList.remove('hidden');
            document.getElementById('user-avatar').classList.remove('hidden');
            
            // Actualizar info de usuario
            document.getElementById('user-avatar').textContent = currentUser.email.charAt(0).toUpperCase();
            document.getElementById('user-role-badge').textContent = 
                currentUser.role === 'comprador' ? 'Comprador' : 
                currentUser.role === 'vendedor' ? 'Vendedor' : 'Admin';
            document.getElementById('user-role-badge').className = 'badge ' + 
                (currentUser.role === 'comprador' ? 'badge-info' : 
                 currentUser.role === 'vendedor' ? 'badge-success' : 'badge-warning');
            
            // Mostrar navegaci√≥n seg√∫n rol
            document.getElementById('nav-dashboard').classList.remove('hidden');
            document.getElementById('nav-solicitudes').classList.remove('hidden');
            document.getElementById('nav-propuestas').classList.remove('hidden');
            document.getElementById('nav-perfil').classList.remove('hidden');
            
            if (currentUser.role === 'admin') {
                document.getElementById('nav-admin').classList.remove('hidden');
            }
            
            // Mostrar men√∫ m√≥vil
            document.querySelector('.mobile-nav').classList.remove('hidden');
        }

        function hideUserUI() {
            // Ocultar elementos de usuario autenticado
            document.getElementById('login-btn').classList.remove('hidden');
            document.getElementById('logout-btn').classList.add('hidden');
            document.getElementById('user-info').classList.add('hidden');
            document.getElementById('user-avatar').classList.add('hidden');
            
            // Ocultar navegaci√≥n
            document.querySelectorAll('.desktop-nav a').forEach(a => {
                if (!a.onclick || a.onclick.toString().includes('landing')) return;
                a.classList.add('hidden');
            });
            
            // Ocultar men√∫ m√≥vil
            document.querySelector('.mobile-nav').classList.add('hidden');
        }

        function showToast(message, type = 'info') {
            // Crear toast
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 16px 24px;
                background: ${type === 'success' ? '#4cc9f0' : type === 'error' ? '#ef233c' : '#4361ee'};
                color: white;
                border-radius: var(--border-radius);
                box-shadow: var(--shadow);
                z-index: 1000;
                animation: fadeIn 0.3s ease;
                max-width: 300px;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Remover despu√©s de 3 segundos
            setTimeout(() => {
                toast.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }

        // ============================================
        // FUNCIONES DE SOLICITUDES
        // ============================================
        function crearSolicitud(event) {
            event.preventDefault();
            
            const data = getData();
            const nuevaSolicitud = {
                id: data.nextIds.solicitudes++,
                userId: currentUser.id,
                tipo: document.getElementById('solicitud-tipo').value,
                titulo: document.getElementById('solicitud-titulo').value,
                descripcion: document.getElementById('solicitud-descripcion').value,
                presupuesto: parseInt(document.getElementById('solicitud-presupuesto').value),
                zona: document.getElementById('solicitud-zona').value,
                urgencia: document.getElementById('solicitud-urgencia').value,
                estado: 'abierto',
                createdAt: new Date().toISOString(),
                propuestas: []
            };
            
            data.solicitudes.push(nuevaSolicitud);
            saveData(data);
            
            showToast('Solicitud publicada exitosamente', 'success');
            showView('dashboard');
        }

        function loadSolicitudes() {
            const data = getData();
            const container = document.getElementById('solicitudes-list');
            
            if (!container) return;
            
            let solicitudes = [];
            
            if (currentUser.role === 'comprador') {
                // Mostrar solo las solicitudes del usuario
                solicitudes = data.solicitudes.filter(s => s.userId === currentUser.id);
            } else if (currentUser.role === 'vendedor') {
                // Mostrar solicitudes activas de otros usuarios
                solicitudes = data.solicitudes.filter(s => s.userId !== currentUser.id && s.estado === 'abierto');
            }
            
            if (solicitudes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <h3>No hay solicitudes</h3>
                        <p>${currentUser.role === 'comprador' ? 'Crea tu primera solicitud para empezar' : 'No hay solicitudes disponibles en este momento'}</p>
                        ${currentUser.role === 'comprador' ? '<button class="btn btn-primary" onclick="showView(\'crear-solicitud\')">Crear Solicitud</button>' : ''}
                    </div>
                `;
                return;
            }
            
            container.innerHTML = solicitudes.map(solicitud => {
                const user = data.users.find(u => u.id === solicitud.userId);
                const propuestasCount = solicitud.propuestas ? solicitud.propuestas.length : 0;
                
                return `
                    <div class="solicitud-card">
                        <div class="solicitud-header">
                            <div>
                                <div class="solicitud-title">${solicitud.titulo}</div>
                                <div class="badge ${solicitud.estado === 'abierto' ? 'badge-success' : solicitud.estado === 'negociando' ? 'badge-warning' : 'badge-danger'}">
                                    ${solicitud.estado}
                                </div>
                            </div>
                            <div class="badge badge-info">${solicitud.tipo}</div>
                        </div>
                        
                        <div class="solicitud-meta">
                            <span><strong>üí∞ Presupuesto:</strong> $${solicitud.presupuesto.toLocaleString()}</span>
                            <span><strong>üìç Zona:</strong> ${solicitud.zona}</span>
                            <span><strong>‚è±Ô∏è Urgencia:</strong> ${solicitud.urgencia}</span>
                        </div>
                        
                        <p style="margin-bottom: 15px;">${solicitud.descripcion.substring(0, 150)}...</p>
                        
                        <div class="solicitud-actions">
                            <button class="btn btn-sm btn-primary" onclick="verDetalleSolicitud(${solicitud.id})">
                                Ver Detalles
                            </button>
                            
                            ${currentUser.role === 'comprador' ? `
                                <button class="btn btn-sm btn-outline" onclick="editarSolicitud(${solicitud.id})">
                                    Editar
                                </button>
                                <button class="btn btn-sm" onclick="eliminarSolicitud(${solicitud.id})">
                                    Eliminar
                                </button>
                            ` : ''}
                            
                            ${currentUser.role === 'vendedor' && solicitud.estado === 'abierto' ? `
                                <button class="btn btn-sm btn-secondary" onclick="enviarPropuesta(${solicitud.id})">
                                    Enviar Propuesta
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function verDetalleSolicitud(id) {
            const data = getData();
            const solicitud = data.solicitudes.find(s => s.id === id);
            const user = data.users.find(u => u.id === solicitud.userId);
            
            const container = document.getElementById('detalle-solicitud-content');
            container.innerHTML = `
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                        <div>
                            <h2>${solicitud.titulo}</h2>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <span class="badge ${solicitud.estado === 'abierto' ? 'badge-success' : solicitud.estado === 'negociando' ? 'badge-warning' : 'badge-danger'}">
                                    ${solicitud.estado}
                                </span>
                                <span class="badge badge-info">${solicitud.tipo}</span>
                                <span class="badge">${solicitud.urgencia} urgencia</span>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">
                                $${solicitud.presupuesto.toLocaleString()}
                            </div>
                            <div style="color: var(--gray); font-size: 0.9rem;">Presupuesto m√°ximo</div>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <h3>Descripci√≥n</h3>
                        <p style="margin-top: 10px; white-space: pre-line;">${solicitud.descripcion}</p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
                        <div class="card" style="padding: 15px;">
                            <div style="font-size: 0.9rem; color: var(--gray);">Zona</div>
                            <div style="font-weight: 600; margin-top: 5px;">${solicitud.zona}</div>
                        </div>
                        <div class="card" style="padding: 15px;">
                            <div style="font-size: 0.9rem; color: var(--gray);">Fecha de publicaci√≥n</div>
                            <div style="font-weight: 600; margin-top: 5px;">${new Date(solicitud.createdAt).toLocaleDateString()}</div>
                        </div>
                        <div class="card" style="padding: 15px;">
                            <div style="font-size: 0.9rem; color: var(--gray);">Publicado por</div>
                            <div style="font-weight: 600; margin-top: 5px;">${user.email}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3>Propuestas (${solicitud.propuestas ? solicitud.propuestas.length : 0})</h3>
                            ${currentUser.role === 'vendedor' && solicitud.estado === 'abierto' ? `
                                <button class="btn btn-secondary" onclick="enviarPropuesta(${solicitud.id})">
                                    Enviar Propuesta
                                </button>
                            ` : ''}
                        </div>
                        
                        <div id="propuestas-solicitud">
                            ${solicitud.propuestas && solicitud.propuestas.length > 0 ? 
                                data.propuestas.filter(p => solicitud.propuestas.includes(p.id)).map(propuesta => `
                                    <div class="propuesta-card" style="margin-bottom: 15px;">
                                        <div style="display: flex; justify-content: space-between;">
                                            <div>
                                                <strong>Precio ofrecido: $${propuesta.precio.toLocaleString()}</strong>
                                            </div>
                                            <div class="badge ${propuesta.estado === 'pendiente' ? 'badge-warning' : propuesta.estado === 'aceptada' ? 'badge-success' : 'badge-danger'}">
                                                ${propuesta.estado}
                                            </div>
                                        </div>
                                        <p style="margin: 10px 0;">${propuesta.mensaje}</p>
                                        <div style="font-size: 0.9rem; color: var(--gray);">
                                            Enviada: ${new Date(propuesta.createdAt).toLocaleDateString()}
                                        </div>
                                        ${currentUser.id === solicitud.userId && solicitud.estado !== 'cerrado' ? `
                                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                                <button class="btn btn-sm btn-success" onclick="aceptarPropuesta(${propuesta.id})">
                                                    Aceptar
                                                </button>
                                                <button class="btn btn-sm btn-outline" onclick="iniciarChat(${propuesta.id})">
                                                    Chatear
                                                </button>
                                            </div>
                                        ` : ''}
                                    </div>
                                `).join('') : 
                                '<p class="empty-state">No hay propuestas a√∫n.</p>'
                            }
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button class="btn" onclick="showView('solicitudes')">Volver</button>
                        ${currentUser.id === solicitud.userId ? `
                            <button class="btn btn-outline" onclick="editarSolicitud(${solicitud.id})">Editar</button>
                            ${solicitud.estado !== 'cerrado' ? `
                                <button class="btn btn-primary" onclick="cambiarEstadoSolicitud(${solicitud.id}, '${solicitud.estado === 'abierto' ? 'negociando' : 'cerrado'}')">
                                    ${solicitud.estado === 'abierto' ? 'Comenzar Negociaci√≥n' : 'Cerrar Solicitud'}
                                </button>
                            ` : ''}
                        ` : ''}
                    </div>
                </div>
            `;
            
            showView('detalle-solicitud');
        }

        // ============================================
        // FUNCIONES DE PROPUESTAS
        // ============================================
        function enviarPropuesta(solicitudId) {
            const data = getData();
            const solicitud = data.solicitudes.find(s => s.id === solicitudId);
            
            const precio = prompt(`Ingresa el precio de tu propuesta para: "${solicitud.titulo}"\nPresupuesto m√°ximo: $${solicitud.presupuesto.toLocaleString()}`);
            if (!precio || isNaN(precio)) {
                showToast('Precio inv√°lido', 'error');
                return;
            }
            
            const mensaje = prompt('Ingresa un mensaje personalizado para el comprador:');
            if (!mensaje) {
                showToast('El mensaje es requerido', 'error');
                return;
            }
            
            const nuevaPropuesta = {
                id: data.nextIds.propuestas++,
                solicitudId: solicitudId,
                vendedorId: currentUser.id,
                precio: parseInt(precio),
                mensaje: mensaje,
                estado: 'pendiente',
                createdAt: new Date().toISOString()
            };
            
            data.propuestas.push(nuevaPropuesta);
            
            // A√±adir propuesta a la solicitud
            if (!solicitud.propuestas) solicitud.propuestas = [];
            solicitud.propuestas.push(nuevaPropuesta.id);
            
            saveData(data);
            showToast('Propuesta enviada exitosamente', 'success');
            showView('dashboard');
        }

        function loadPropuestasRecibidas() {
            const data = getData();
            const container = document.getElementById('propuestas-recibidas-list');
            
            if (!container) return;
            
            // Solo para compradores
            if (currentUser.role !== 'comprador') {
                container.innerHTML = '<p class="empty-state">Esta secci√≥n es solo para compradores.</p>';
                return;
            }
            
            const misSolicitudesIds = data.solicitudes
                .filter(s => s.userId === currentUser.id)
                .map(s => s.id);
            
            const propuestasRecibidas = data.propuestas
                .filter(p => misSolicitudesIds.includes(p.solicitudId));
            
            if (propuestasRecibidas.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì®</div>
                        <h3>No hay propuestas recibidas</h3>
                        <p>Crea solicitudes para recibir propuestas de vendedores</p>
                        <button class="btn btn-primary" onclick="showView('crear-solicitud')">Crear Solicitud</button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = propuestasRecibidas.map(propuesta => {
                const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
                const vendedor = data.users.find(u => u.id === propuesta.vendedorId);
                
                return `
                    <div class="propuesta-card">
                        <div class="propuesta-header">
                            <div class="propuesta-title">Propuesta para: ${solicitud.titulo}</div>
                            <div class="badge ${propuesta.estado === 'pendiente' ? 'badge-warning' : propuesta.estado === 'aceptada' ? 'badge-success' : 'badge-danger'}">
                                ${propuesta.estado}
                            </div>
                        </div>
                        
                        <div class="propuesta-meta">
                            <span><strong>üí∞ Precio:</strong> $${propuesta.precio.toLocaleString()}</span>
                            <span><strong>üë§ Vendedor:</strong> ${vendedor.email}</span>
                            <span><strong>üìÖ Fecha:</strong> ${new Date(propuesta.createdAt).toLocaleDateString()}</span>
                        </div>
                        
                        <p><strong>Mensaje:</strong> ${propuesta.mensaje}</p>
                        
                        <div class="propuesta-actions">
                            <button class="btn btn-sm btn-success" onclick="aceptarPropuesta(${propuesta.id})">
                                Aceptar
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="iniciarChat(${propuesta.id})">
                                Chatear
                            </button>
                            <button class="btn btn-sm" onclick="rechazarPropuesta(${propuesta.id})">
                                Rechazar
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ============================================
        // FUNCIONES DE CHAT
        // ============================================
        function iniciarChat(propuestaId) {
            const data = getData();
            const propuesta = data.propuestas.find(p => p.id === propuestaId);
            const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
            
            // Buscar chat existente o crear uno nuevo
            let chat = data.chats.find(c => 
                c.solicitudId === propuesta.solicitudId && 
                c.participantes.includes(currentUser.id) && 
                c.participantes.includes(propuesta.vendedorId)
            );
            
            if (!chat) {
                chat = {
                    id: data.nextIds.chats++,
                    solicitudId: propuesta.solicitudId,
                    participantes: [currentUser.id, propuesta.vendedorId],
                    mensajes: []
                };
                data.chats.push(chat);
                saveData(data);
            }
            
            // Mostrar interfaz de chat
            const container = document.getElementById('chat-container');
            const otroUsuarioId = chat.participantes.find(id => id !== currentUser.id);
            const otroUsuario = data.users.find(u => u.id === otroUsuarioId);
            
            container.innerHTML = `
                <div class="chat-container">
                    <div class="chat-header">
                        <div>
                            <h3 style="margin: 0;">Chat: ${solicitud.titulo}</h3>
                            <p style="margin: 5px 0 0 0; opacity: 0.9;">Con: ${otroUsuario.email}</p>
                        </div>
                        <button class="btn btn-sm" onclick="showView('dashboard')">Cerrar</button>
                    </div>
                    
                    <div class="chat-messages" id="chat-messages">
                        ${chat.mensajes.map(mensaje => {
                            const esMio = mensaje.userId === currentUser.id;
                            return `
                                <div class="message ${esMio ? 'message-sent' : 'message-received'}">
                                    <div>${mensaje.text}</div>
                                    <div class="message-time">
                                        ${new Date(mensaje.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="chat-input">
                        <input type="text" id="chat-input-text" placeholder="Escribe tu mensaje..." onkeypress="if(event.key === 'Enter') enviarMensajeChat(${chat.id})">
                        <button class="btn btn-primary" onclick="enviarMensajeChat(${chat.id})">Enviar</button>
                    </div>
                </div>
            `;
            
            showView('chat');
            // Auto-scroll al final del chat
            setTimeout(() => {
                const messagesContainer = document.getElementById('chat-messages');
                if (messagesContainer) {
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }
            }, 100);
        }

        function enviarMensajeChat(chatId) {
            const input = document.getElementById('chat-input-text');
            const texto = input.value.trim();
            
            if (!texto) return;
            
            const data = getData();
            const chat = data.chats.find(c => c.id === chatId);
            
            if (!chat) return;
            
            const nuevoMensaje = {
                id: chat.mensajes.length + 1,
                userId: currentUser.id,
                text: texto,
                timestamp: new Date().toISOString()
            };
            
            chat.mensajes.push(nuevoMensaje);
            saveData(data);
            
            // Limpiar input y actualizar chat
            input.value = '';
            iniciarChat(data.propuestas.find(p => 
                p.solicitudId === chat.solicitudId && 
                (p.vendedorId === currentUser.id || data.solicitudes.find(s => s.id === chat.solicitudId).userId === currentUser.id)
            )?.id || 0);
        }

        // ============================================
        // FUNCIONES DEL PANEL ADMIN
        // ============================================
        function loadAdminPanel() {
            const data = getData();
            
            // Usuarios
            const usersList = document.getElementById('admin-users-list');
            usersList.innerHTML = data.users.map(user => `
                <tr>
                    <td>${user.id}</td>
                    <td>${user.email}</td>
                    <td><span class="badge ${user.role === 'admin' ? 'badge-warning' : user.role === 'vendedor' ? 'badge-success' : 'badge-info'}">${user.role}</span></td>
                    <td>${new Date(user.createdAt).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-sm" onclick="eliminarUsuario(${user.id})" ${user.id === currentUser.id ? 'disabled' : ''}>Eliminar</button>
                    </td>
                </tr>
            `).join('');
            
            // Solicitudes
            const solicitudesList = document.getElementById('admin-solicitudes-list');
            solicitudesList.innerHTML = data.solicitudes.map(solicitud => {
                const user = data.users.find(u => u.id === solicitud.userId);
                return `
                    <tr>
                        <td>${solicitud.id}</td>
                        <td>${solicitud.titulo}</td>
                        <td><span class="badge badge-info">${solicitud.tipo}</span></td>
                        <td>${user.email}</td>
                        <td>$${solicitud.presupuesto.toLocaleString()}</td>
                        <td><span class="badge ${solicitud.estado === 'abierto' ? 'badge-success' : solicitud.estado === 'negociando' ? 'badge-warning' : 'badge-danger'}">${solicitud.estado}</span></td>
                        <td>
                            <button class="btn btn-sm" onclick="eliminarSolicitudAdmin(${solicitud.id})">Eliminar</button>
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Propuestas
            const propuestasList = document.getElementById('admin-propuestas-list');
            propuestasList.innerHTML = data.propuestas.map(propuesta => {
                const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
                const vendedor = data.users.find(u => u.id === propuesta.vendedorId);
                return `
                    <tr>
                        <td>${propuesta.id}</td>
                        <td>${solicitud?.titulo || 'N/A'}</td>
                        <td>${vendedor.email}</td>
                        <td>$${propuesta.precio.toLocaleString()}</td>
                        <td>${new Date(propuesta.createdAt).toLocaleDateString()}</td>
                        <td><span class="badge ${propuesta.estado === 'pendiente' ? 'badge-warning' : propuesta.estado === 'aceptada' ? 'badge-success' : 'badge-danger'}">${propuesta.estado}</span></td>
                        <td>
                            <button class="btn btn-sm" onclick="eliminarPropuestaAdmin(${propuesta.id})">Eliminar</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function resetSystem() {
            if (confirm('‚ö†Ô∏è ¬øEST√ÅS SEGURO? Esto eliminar√° todos los datos excepto los usuarios de ejemplo y reiniciar√° el sistema.')) {
                saveData(initialData);
                showToast('Sistema reiniciado exitosamente', 'success');
                loadAdminPanel();
            }
        }

        // ============================================
        // FUNCIONES AUXILIARES
        // ============================================
        function updateDashboard() {
            if (!currentUser) return;
            
            const data = getData();
            
            if (currentUser.role === 'comprador') {
                const misSolicitudes = data.solicitudes.filter(s => s.userId === currentUser.id);
                const propuestasRecibidas = data.propuestas.filter(p => 
                    misSolicitudes.some(s => s.id === p.solicitudId)
                );
                
                document.getElementById('stat-solicitudes').textContent = misSolicitudes.filter(s => s.estado === 'abierto').length;
                document.getElementById('stat-propuestas').textContent = propuestasRecibidas.length;
                document.getElementById('stat-negociando').textContent = misSolicitudes.filter(s => s.estado === 'negociando').length;
                document.getElementById('stat-cerradas').textContent = misSolicitudes.filter(s => s.estado === 'cerrado').length;
                
                // Solicitudes recientes
                const solicitudesContainer = document.getElementById('dashboard-solicitudes');
                solicitudesContainer.innerHTML = misSolicitudes.slice(0, 3).map(solicitud => `
                    <div class="solicitud-card">
                        <div class="solicitud-title">${solicitud.titulo}</div>
                        <div style="display: flex; gap: 10px; margin: 10px 0;">
                            <span class="badge ${solicitud.estado === 'abierto' ? 'badge-success' : solicitud.estado === 'negociando' ? 'badge-warning' : 'badge-danger'}">
                                ${solicitud.estado}
                            </span>
                            <span class="badge badge-info">${solicitud.tipo}</span>
                        </div>
                        <p style="margin-bottom: 15px;">${solicitud.descripcion.substring(0, 80)}...</p>
                        <button class="btn btn-sm btn-primary" onclick="verDetalleSolicitud(${solicitud.id})">Ver Detalles</button>
                    </div>
                `).join('');
                
                // Propuestas recientes
                const propuestasContainer = document.getElementById('dashboard-propuestas');
                if (propuestasRecibidas.length > 0) {
                    propuestasContainer.innerHTML = propuestasRecibidas.slice(0, 3).map(propuesta => {
                        const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
                        return `
                            <div class="propuesta-card">
                                <div><strong>Para:</strong> ${solicitud.titulo}</div>
                                <div style="margin: 10px 0;"><strong>üí∞ $${propuesta.precio.toLocaleString()}</strong></div>
                                <button class="btn btn-sm btn-primary" onclick="verDetalleSolicitud(${solicitud.id})">Ver</button>
                            </div>
                        `;
                    }).join('');
                } else {
                    propuestasContainer.innerHTML = '<div class="empty-state">No hay propuestas recibidas a√∫n</div>';
                }
                
            } else if (currentUser.role === 'vendedor') {
                const solicitudesActivas = data.solicitudes.filter(s => s.userId !== currentUser.id && s.estado === 'abierto');
                const misPropuestas = data.propuestas.filter(p => p.vendedorId === currentUser.id);
                
                document.getElementById('stat-solicitudes').textContent = solicitudesActivas.length;
                document.getElementById('stat-propuestas').textContent = misPropuestas.length;
                document.getElementById('stat-negociando').textContent = misPropuestas.filter(p => p.estado === 'aceptada').length;
                document.getElementById('stat-cerradas').textContent = 0;
                
                // Solicitudes activas
                const solicitudesContainer = document.getElementById('dashboard-solicitudes');
                if (solicitudesActivas.length > 0) {
                    solicitudesContainer.innerHTML = solicitudesActivas.slice(0, 3).map(solicitud => `
                        <div class="solicitud-card">
                            <div class="solicitud-title">${solicitud.titulo}</div>
                            <div style="margin: 10px 0;"><strong>üí∞ Presupuesto: $${solicitud.presupuesto.toLocaleString()}</strong></div>
                            <button class="btn btn-sm btn-secondary" onclick="enviarPropuesta(${solicitud.id})">Enviar Propuesta</button>
                        </div>
                    `).join('');
                } else {
                    solicitudesContainer.innerHTML = '<div class="empty-state">No hay solicitudes activas disponibles</div>';
                }
                
                // Mis propuestas
                const propuestasContainer = document.getElementById('dashboard-propuestas');
                if (misPropuestas.length > 0) {
                    propuestasContainer.innerHTML = misPropuestas.slice(0, 3).map(propuesta => {
                        const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
                        return `
                            <div class="propuesta-card">
                                <div><strong>Para:</strong> ${solicitud.titulo}</div>
                                <div style="margin: 10px 0;"><strong>üí∞ $${propuesta.precio.toLocaleString()}</strong></div>
                                <div class="badge ${propuesta.estado === 'pendiente' ? 'badge-warning' : 'badge-success'}">${propuesta.estado}</div>
                            </div>
                        `;
                    }).join('');
                } else {
                    propuestasContainer.innerHTML = '<div class="empty-state">No has enviado propuestas a√∫n</div>';
                }
            }
        }

        // ============================================
        // PWA FUNCTIONALITY
        // ============================================
        // Generar manifest din√°micamente
        function generateManifest() {
            const manifest = {
                name: "MarketPlace Inverso",
                short_name: "MPInverso",
                description: "Marketplace inverso donde los compradores publican demandas",
                start_url: "./",
                display: "standalone",
                background_color: "#4361ee",
                theme_color: "#4361ee",
                icons: [
                    {
                        src: "data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%234361ee%22>üîÑ</text></svg>",
                        sizes: "any",
                        type: "image/svg+xml"
                    }
                ]
            };
            
            const manifestBlob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
            const manifestURL = URL.createObjectURL(manifestBlob);
            document.getElementById('manifest-placeholder').href = manifestURL;
        }

        // Service Worker embebido
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                const swCode = `
                    self.addEventListener('install', (event) => {
                        event.waitUntil(
                            caches.open('marketplace-v1').then((cache) => {
                                return cache.addAll([
                                    './',
                                    './index.html'
                                ]);
                            })
                        );
                    });
                    
                    self.addEventListener('fetch', (event) => {
                        event.respondWith(
                            caches.match(event.request).then((response) => {
                                return response || fetch(event.request);
                            })
                        );
                    });
                `;
                
                const swBlob = new Blob([swCode], {type: 'application/javascript'});
                const swURL = URL.createObjectURL(swBlob);
                
                navigator.serviceWorker.register(swURL)
                    .then(() => console.log('Service Worker registrado'))
                    .catch(err => console.log('Error SW:', err));
            }
        }

        // Instalaci√≥n PWA
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            const installBtn = document.getElementById('install-btn');
            const installPWA = document.getElementById('install-pwa');
            
            if (installBtn && installPWA) {
                installPWA.classList.remove('hidden');
                
                installBtn.addEventListener('click', () => {
                    installPWA.classList.add('hidden');
                    deferredPrompt.prompt();
                    
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('Usuario instal√≥ la PWA');
                        }
                        deferredPrompt = null;
                    });
                });
            }
        });

        // ============================================
        // INICIALIZACI√ìN
        // ============================================
        window.addEventListener('DOMContentLoaded', () => {
            // Inicializar datos
            getData();
            
            // Verificar autenticaci√≥n
            checkAuth();
            
            // Configurar PWA
            generateManifest();
            registerServiceWorker();
            
            // Configurar eventos globales
            document.addEventListener('click', function(e) {
                if (e.target.matches('[data-view]')) {
                    showView(e.target.getAttribute('data-view'));
                }
            });
            
            // Inicializar vista predeterminada
            if (!currentUser) {
                showView('landing');
            }
            
            // Cargar datos de ejemplo si es la primera vez
            if (!localStorage.getItem(APP_KEY)) {
                console.log('Datos iniciales cargados');
            }
        });

        // ============================================
        // FUNCIONES PENDIENTES (simplificadas)
        // ============================================
        function toggleFilters() {
            const filters = document.getElementById('filters-container');
            filters.classList.toggle('hidden');
        }
        
        function aplicarFiltros() {
            showToast('Filtros aplicados', 'success');
            loadSolicitudes();
        }
        
        function limpiarFiltros() {
            document.getElementById('filter-tipo').value = '';
            document.getElementById('filter-presupuesto').value = '';
            document.getElementById('filter-estado').value = '';
            showToast('Filtros limpiados', 'info');
            loadSolicitudes();
        }
        
        function editarSolicitud(id) {
            showToast('Funci√≥n de edici√≥n en desarrollo', 'info');
        }
        
        function eliminarSolicitud(id) {
            if (confirm('¬øEliminar esta solicitud? Esto tambi√©n eliminar√° las propuestas asociadas.')) {
                const data = getData();
                data.solicitudes = data.solicitudes.filter(s => s.id !== id);
                saveData(data);
                showToast('Solicitud eliminada', 'success');
                loadSolicitudes();
                updateDashboard();
            }
        }
        
        function aceptarPropuesta(id) {
            const data = getData();
            const propuesta = data.propuestas.find(p => p.id === id);
            propuesta.estado = 'aceptada';
            
            // Cambiar estado de la solicitud
            const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
            solicitud.estado = 'negociando';
            
            saveData(data);
            showToast('Propuesta aceptada. Estado cambiado a "negociando"', 'success');
            
            // Actualizar vista actual
            if (document.getElementById('detalle-solicitud').classList.contains('active')) {
                verDetalleSolicitud(propuesta.solicitudId);
            } else {
                loadPropuestasRecibidas();
            }
        }
        
        function rechazarPropuesta(id) {
            const data = getData();
            const propuesta = data.propuestas.find(p => p.id === id);
            propuesta.estado = 'rechazada';
            saveData(data);
            showToast('Propuesta rechazada', 'success');
            loadPropuestasRecibidas();
        }
        
        function cambiarEstadoSolicitud(id, nuevoEstado) {
            const data = getData();
            const solicitud = data.solicitudes.find(s => s.id === id);
            solicitud.estado = nuevoEstado;
            saveData(data);
            showToast(`Estado cambiado a "${nuevoEstado}"`, 'success');
            verDetalleSolicitud(id);
        }
        
        function loadPropuestasEnviadas() {
            const data = getData();
            const container = document.getElementById('propuestas-enviadas-list');
            
            if (!container) return;
            
            // Solo para vendedores
            if (currentUser.role !== 'vendedor') {
                container.innerHTML = '<p class="empty-state">Esta secci√≥n es solo para vendedores.</p>';
                return;
            }
            
            const misPropuestas = data.propuestas.filter(p => p.vendedorId === currentUser.id);
            
            if (misPropuestas.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì§</div>
                        <h3>No has enviado propuestas</h3>
                        <p>Busca solicitudes activas y env√≠a tu primera propuesta</p>
                        <button class="btn btn-primary" onclick="showView('solicitudes')">Ver Solicitudes</button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = misPropuestas.map(propuesta => {
                const solicitud = data.solicitudes.find(s => s.id === propuesta.solicitudId);
                const comprador = data.users.find(u => u.id === solicitud.userId);
                
                return `
                    <div class="propuesta-card">
                        <div class="propuesta-header">
                            <div class="propuesta-title">${solicitud.titulo}</div>
                            <div class="badge ${propuesta.estado === 'pendiente' ? 'badge-warning' : propuesta.estado === 'aceptada' ? 'badge-success' : 'badge-danger'}">
                                ${propuesta.estado}
                            </div>
                        </div>
                        
                        <div class="propuesta-meta">
                            <span><strong>üí∞ Precio ofrecido:</strong> $${propuesta.precio.toLocaleString()}</span>
                            <span><strong>üë§ Comprador:</strong> ${comprador.email}</span>
                            <span><strong>üìÖ Fecha:</strong> ${new Date(propuesta.createdAt).toLocaleDateString()}</span>
                        </div>
                        
                        <p><strong>Mi mensaje:</strong> ${propuesta.mensaje}</p>
                        
                        <div class="propuesta-actions">
                            <button class="btn btn-sm btn-outline" onclick="iniciarChat(${propuesta.id})">
                                Chatear
                            </button>
                            <button class="btn btn-sm" onclick="editarPropuesta(${propuesta.id})">
                                Editar
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function loadProfile() {
            const container = document.getElementById('profile-info');
            container.innerHTML = `
                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
                    <div class="user-avatar" style="width: 80px; height: 80px; font-size: 2rem;">
                        ${currentUser.email.charAt(0).toUpperCase()}
                    </div>
                    <div>
                        <h3 style="margin: 0 0 10px 0;">${currentUser.email}</h3>
                        <div class="badge ${currentUser.role === 'comprador' ? 'badge-info' : currentUser.role === 'vendedor' ? 'badge-success' : 'badge-warning'}" style="font-size: 1rem;">
                            ${currentUser.role === 'comprador' ? 'Comprador' : currentUser.role === 'vendedor' ? 'Vendedor' : 'Administrador'}
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div class="card" style="padding: 15px;">
                        <div style="font-size: 0.9rem; color: var(--gray);">Fecha de registro</div>
                        <div style="font-weight: 600; margin-top: 5px;">${new Date(currentUser.createdAt).toLocaleDateString()}</div>
                    </div>
                    
                    <div class="card" style="padding: 15px;">
                        <div style="font-size: 0.9rem; color: var(--gray);">ID de usuario</div>
                        <div style="font-weight: 600; margin-top: 5px;">${currentUser.id}</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3>Configuraci√≥n de cuenta</h3>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-outline" onclick="cambiarPassword()">Cambiar contrase√±a</button>
                        <button class="btn" onclick="exportarDatos()" style="margin-left: 10px;">Exportar mis datos</button>
                    </div>
                </div>
            `;
        }
        
        function cambiarPassword() {
            const nuevaPassword = prompt('Ingresa tu nueva contrase√±a (m√≠nimo 6 caracteres):');
            if (nuevaPassword && nuevaPassword.length >= 6) {
                const data = getData();
                const user = data.users.find(u => u.id === currentUser.id);
                user.password = nuevaPassword;
                saveData(data);
                showToast('Contrase√±a actualizada exitosamente', 'success');
            } else if (nuevaPassword) {
                showToast('La contrase√±a debe tener al menos 6 caracteres', 'error');
            }
        }
        
        function exportarDatos() {
            const data = getData();
            const userData = {
                usuario: currentUser,
                solicitudes: data.solicitudes.filter(s => s.userId === currentUser.id),
                propuestas: currentUser.role === 'vendedor' ? 
                    data.propuestas.filter(p => p.vendedorId === currentUser.id) :
                    data.propuestas.filter(p => 
                        data.solicitudes.some(s => s.id === p.solicitudId && s.userId === currentUser.id)
                    ),
                chats: data.chats.filter(c => c.participantes.includes(currentUser.id))
            };
            
            const dataStr = JSON.stringify(userData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `marketplace_inverso_${currentUser.email}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showToast('Datos exportados exitosamente', 'success');
        }
        
        function eliminarUsuario(id) {
            if (confirm('¬øEliminar este usuario? Esta acci√≥n no se puede deshacer.')) {
                const data = getData();
                data.users = data.users.filter(u => u.id !== id);
                saveData(data);
                loadAdminPanel();
                showToast('Usuario eliminado', 'success');
            }
        }
        
        function eliminarSolicitudAdmin(id) {
            if (confirm('¬øEliminar esta solicitud y todas sus propuestas?')) {
                const data = getData();
                // Eliminar propuestas asociadas
                data.propuestas = data.propuestas.filter(p => p.solicitudId !== id);
                // Eliminar solicitud
                data.solicitudes = data.solicitudes.filter(s => s.id !== id);
                saveData(data);
                loadAdminPanel();
                showToast('Solicitud eliminada', 'success');
            }
        }
        
        function eliminarPropuestaAdmin(id) {
            if (confirm('¬øEliminar esta propuesta?')) {
                const data = getData();
                data.propuestas = data.propuestas.filter(p => p.id !== id);
                saveData(data);
                loadAdminPanel();
                showToast('Propuesta eliminada', 'success');
            }
        }
        
        function editarPropuesta(id) {
            showToast('Funci√≥n de edici√≥n de propuestas en desarrollo', 'info');
        }
    </script>
</body>
</html>
